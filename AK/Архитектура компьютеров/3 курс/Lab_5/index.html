<!doctype html>
<html>

<head>
<meta charset="windows-1251">
<link rel=File-List href="index.files/filelist.xml">
<link rel=stylesheet href="../style.css">
<title>ММХ</title>
</head>

<body>
<a href="../index.html">Содержание</a>
<h2><a name="_Toc468083310">5. ИЗУЧЕНИЕ ПРИНЦИПОВ ТЕХНОЛОГИИ ММХ</a></h2>
<h3>5.1. Цель работы</h3>

<p>Ознакомление с основополагающими принципами технологии ММХ и ее реализацией в современных микропроцессорах, типами данных и командами ММХ-расширения процессора, особенностями арифметики с насыщением и циклической арифметики.</p>

<h3>5.2 Порядок выполнения работы</h3>

<p>Выполнение лабораторной работы основано на изучении теоретических
вопросов и выполнении демонстрационно-тестовых заданий с помощью
информационно-справочной системы <a href="MMXtutor/MMX.HTM">«Введение в
технологию MMX»</a>, разработанной корпорацией Intel.</p>

<p>Работа с указанной системой должна быть проведена в следующей
последовательности:</p>

<p>1. Рассмотреть пример, иллюстрирующий принцип SIMD(тема 5)</p>

<p>2. Изучить типы данных (тема 6), обратив особое внимание на
диапазоны их значений.</p>

<p>5. Изучить синтаксис команд (тема 7) и выполнить тестовый пример.</p>

<p>4. Изучить отличительные особенности выполнения операций по правилам
циклической арифметики и арифметики с насыщением, а также особенности обработки
чисел со знаком и без знака (темы 8-9). Также следует выполнить тестовые
примеры.</p>

<p>5. Рассмотреть классификацию команд и изучить назначение групп
команд:</p>
<ul>
<li>сложения и вычитания;</li>

<li>сдвига;</li>

<li>логических операций; </li>

<li>умножения;</li>

<li>сравнения;</li>

<li>упаковки и распаковки;</li>

<li>предачи данных.</li>
</ul>
<p>6. В соответствии с вариантом задания изучить назначение и особенности
выполнения трех заданных команд.</p>

<p><o:p>&nbsp;</o:p></p>

<table border=1>
 <tr>
  <th>Вар-т</th>
  <th>Команда 1</th>
  <th>Команда 2</th>
  <th>Команда 3</th>
 </tr>
 <tr>
  <td>1</td>
  <td>paddw</td>
  <td>packsswb</td>
  <td>movd</td>
 </tr>
 <tr>
  <td>2</td>
  <td>psubd</td>
  <td>punpckhdq</td>
  <td>movq</td>
 </tr>
 <tr>
  <td>3</td>
  <td>paddsb</td>
  <td>packuswd</td>
  <td>pcmpeqb</td>
 </tr>
 <tr>
  <td>4</td>
  <td>psubsw</td>
  <td>punpcklbw</td>
  <td>pcmpgtb</td>
 </tr>
 <tr>
  <td>5</td>
  <td>paddusb</td>
  <td>pand</td>
  <td>pcmpeqd</td>
 </tr>
 <tr>
  <td>6</td>
  <td>psubusw</td>
  <td>por</td>
  <td>pcmpgtd</td>
 </tr>
 <tr>
  <td>7</td>
  <td>paddbd</td>
  <td>pandn</td>
  <td>pmaddwd</td>
 </tr>
 <tr>
  <td>8</td>
  <td>psubw</td>
  <td>pxor</td>
  <td>pmaddwd</td>
 </tr>
 <tr>
  <td>9</td>
  <td>paddsb</td>
  <td>pmulhw</td>
  <td>pcmpeqw</td>
 </tr>
 <tr>
  <td>10</td>
  <td>psubsb</td>
  <td>pmullw</td>
  <td>pcmpgtw</td>
 </tr>
</table>

<h3>5.3 Принципы
технологии MMX</h3>

<p>Объем и сложность данных, обрабатываемых современными компьютерами,
стремительно увеличиваются. Новые средства связи, видео- и аудиоприложения
выдвигают повышенные требования к производительности микропроцессора.</p>

<p>Технология ММХ (MultiMedia eXtension) была разработана
для ускорения мультимедийных и коммуникационных программ. В ее программное
окружение были введены новые команды и типы данных, что позволило создавать
приложения нового уровня. Технология основана на параллельной обра­ботке
данных. При этом сохраняется полная совместимость с существующими операционными
системами и программным обеспечением. По сути, технология ММХ представляет одно
из самых значительных усовершенствова­ний со времени создания процессора
Intel386 (т.е. создания 32-разрядной архитектуры).</p>

<p>В основе ММХ лежит принцип SIMD (Single Instruction-Multiple Data - «одиночный
поток команд, множественный поток данных»). Он означает, что посредством одной
команды можно обработать сразу несколько единиц информации. В технологии MMX
этот принцип реализован в виде выполнения арифметических и логических операций
на байтах, словах, или двойных словах, упакованных в 64-разрядные регистры MMX.
Например, команда PADDSB добавляет восемь знаковых чисел длиной в один байт
первого операнда к восьми знаковым числам так же длиной в один байт второго
операнда и сохраняет 8 результирующих байтов в первом операнде. Эффект SIMD
заключается в ускорении выполнения программного обеспечения за счет
параллельного выполнения одной операции над множеством элементов данных.</p>

<p>Следует заметить, что в памяти новые типы данных располагаются так,
как это принято в архитектуре Intel, т.е. по принципу - младший байт первым.</p>

<p>Наибольший эффект от использования ММХ-технологии может быть
достигнут в алгоритмах, имеющих следующие характеристики:</p>

<ul>
<li>малый размер данных (чаще всего звуковые данные представляются в
виде 16-разрядных слов. В этом случае одна MMX команда может одновременно
обрабатывать 4 из этих слов. Графическая
и видеоинформация обычно представляются наборами байтов. Тогда одна MMX команда может обрабатывать одновременно 8 байт);</li>

<li>короткие, часто повторяющиеся циклы (выполнение однотипных операций над множеством данных);</li>

<li>частые умножения и накопления.</li>
</ul>
<p>Технология ММХ поддерживает новую арифметику, называе­мую
арифметикой с насыщением (Saturation arithmetic), в противовес традиционной -
арифметике с циклическим переносом (Wraparound arithmetic).</p>

<p class="center"><img src="MMXtutor/psubsb.png" alt="Арифметика с циклическим переносом" title="Арифметика с циклическим переносом" label="Рис. 1. Арифметика с циклическим переносом" /></p>
<p class="center">Рис. 1. Арифметика с циклическим переносом</p>

<p class="center"><img src="MMXtutor/psubb.png" alt="Арифметика с насыщением" title="Арифметика с насыщением" label="Рис. 2. Арифметика с насыщением" /></p>
<p class="center">Рис. 2. Арифметика с насыщением</p>

<p>Команды MMX используют восемь 64-разрядных регистров. Для обеспечения полной совместимости с
существующим стандартным программным обеспечением регистры ММХ отображаются на
регистры FPU. Прямой доступ к ним осуществляется по именам MM0,
..., MM7. Только MMX-команды могут обращаться
к этим регистрам. Физически регистры MMX размещены в мантиссах регистров с
плавающей запятой (биты 0-63). Таким образом, любое записываемое в MMX-регистр значение
попадает в один из регистров с плавающей запятой. При выполнении MMX-команд все
биты порядка и знаковый бит в соответствующем регистре с плавающей запятой
(разряды 64-79) заполняются единицами.</p>

<p>Таблица 5.1 - Влияние ММХ-команд на контекст FPU</p>

<table border=1>
 <tr>
  <th>Тип команды</th>
  <th>Регистр тегов</th>
  <th>Поле порядка и знаковый бит<br>
  р-ра MMn (79...64)</th>
  <th>Поле мантиссы<br>
  р-ра MMn (63...00)</th>
 </tr>
 <tr>
  <td>Чтение из ММХ-регистра</td>
  <td>Все поля 00</td>
  <td>Не изменяется</td>
  <td>Не изменяется</td>
 </tr>
 <tr>
  <td>Запись в ММХ-регистр</td>
  <td>Все поля 00</td>
  <td>Заполняется единицами</td>
  <td>Перезаписывается</td>
 </tr>
 <tr>
  <td>EMMS</td>
  <td>Все поля 11</td>
  <td>Не изменяется</td>
  <td>Не изменяется</td>
 </tr>
</table>

<p>После выполнения любой ММХ-команды (кроме EMMS) значения всех полей регистра тегов устанавливаются в 00. Команда EMMS  устанавливает значения всех полей регистра тегов в 11. Значение регистра тегов не оказывает никакого влияния на ММХ-регистры или выполнение ММХ-команд.</p>

<h3>5.4 Содержание отчета</h3>
<p>Отчет по лабораторной работе должен содержать: цель работы, описание основных принципов и элементов (типы данных, синтаксис команд) технологии MMX, назначение отдельных групп команд, результаты выполнения тестовых заданий тем 7 и 9, описание трех заданных команд, выводы по работе.</p>

<h3>5.5 Контрольные вопросы и задания</h3>

<ol>
<li>Что представляет собой
технология ММХ? Для каких алгоритмов она наиболее эффективна?</li>
<li>Какие новые 64-разрядные
типы данных введены технологией ММХ?</li>
<li>Чем отличается арифметика
с насыщением от арифметики с циклическим переносом? Привести примеры.</li>
<li>Какой синтаксис имеют ММХ-команды?</li>
<li>Перечислите известные суффиксы команд ММХ и дать их объяснение.</li>
<li>Каким образом поддерживается совместимость процессоров технологии ММХ с программным обеспечением, написанным для более ранних процессоров?</li>
<li>Перечислить допустимые диапазоны
значений для 8-, 16- и 32-разрядных типов данных.</li>
<li>Где физически располагаются ММХ-регистры и каким образом в них размещаются данные?</li>
<li>Для решения какого класса задач используется арифметика с насыщением?</li>
</ol>

</body>
</html>
